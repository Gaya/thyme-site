<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Thyme - Remove Service Workers</title>
</head>
<body>
<script>
  (function() {
    if (!navigator.serviceWorker) {
      document.write('No service workers available');
      window.location = '/';
      return;
    }

    console.log('Listing service workers');

    navigator.serviceWorker.getRegistrations()
      .then(registrations => {
        Promise.all(
          registrations.map(registration => {
            console.log(`Removing ${registration.active.scriptURL}`);

            return registration.unregister()
              .then(done => {
                if (done) {
                  console.log(`Unregistered ${registration.active.scriptURL}`);
                } else {
                  console.log(`Could not unregister ${registration.active.scriptURL}`);
                }

                return done;
              });
          })
        ).then(() => {
          console.log('Done.');
          window.location = '/';
        });
      });
  })();
</script>
</body>
</html>
